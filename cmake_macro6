#pushd ..
#sd "flto=full" "flto=16" -r "*.cmake"
#popd
cmake -G Ninja ../llvm \
-DBUILD_SHARED_LIBS:BOOL=OFF \
-DLIB_INSTALL_DIR=%{_libdir} \
-DLIB_SUFFIX=64 \
-DLLVM_LIBDIR_SUFFIX=64 \
-DCMAKE_AR=/usr/bin/gcc-ar \
-DCMAKE_BUILD_TYPE=Release \
-DCMAKE_C_COMPILER=gcc \
-DCMAKE_CXX_COMPILER=g++ \
-DCMAKE_INSTALL_LIBDIR=%{_libdir} \
-DCMAKE_INSTALL_PREFIX=/usr \
-DCMAKE_INSTALL_SBINDIR=%{_sbindir} \
-DLLVM_PARALLEL_COMPILE_JOBS:STRING=16 \
-DLLVM_PARALLEL_LINK_JOBS:STRING=6 \
-DCMAKE_NM=/usr/bin/gcc-nm \
-DCMAKE_RANLIB=/usr/bin/gcc-ranlib \
-DCMAKE_VERBOSE_MAKEFILE:BOOL=ON \
-DCMAKE_C_FLAGS="-O3 --param=lto-max-streaming-parallelism=16 -flto=16 -Wl,--no-as-needed -pthread -lpthread -ffat-lto-objects -fuse-ld=bfd -fuse-linker-plugin -march=native -mtune=native -Wall -Wl,-O2 -falign-functions=32 -flimit-function-alignment -malign-data=cacheline -pipe -Wl,--sort-common -fno-stack-protector -Wl,--build-id=sha1 -fexceptions" \
-DCMAKE_CXX_FLAGS="-O3 --param=lto-max-streaming-parallelism=16 -flto=16 -Wl,--no-as-needed -pthread -lpthread -ffat-lto-objects -fuse-ld=bfd -fuse-linker-plugin -march=native -mtune=native -Wall -Wl,-O2 -falign-functions=32 -flimit-function-alignment -malign-data=cacheline -pipe -Wl,--sort-common -fno-stack-protector -Wl,--build-id=sha1 -fexceptions" \
-DCMAKE_EXE_LINKER_FLAGS="-O3 --param=lto-max-streaming-parallelism=16 -flto=16 -Wl,--no-as-needed -pthread -lpthread -ffat-lto-objects -fuse-ld=bfd -fuse-linker-plugin -march=native -mtune=native -Wall -Wl,-O2 -falign-functions=32 -flimit-function-alignment -malign-data=cacheline -pipe -Wl,--sort-common -fno-stack-protector -Wl,--build-id=sha1 -fexceptions" \
-DCMAKE_MODULE_LINKER_FLAGS="-O3 --param=lto-max-streaming-parallelism=16 -flto=16 -Wl,--no-as-needed -pthread -lpthread -ffat-lto-objects -fuse-ld=bfd -fuse-linker-plugin -march=native -mtune=native -Wall -Wl,-O2 -falign-functions=32 -flimit-function-alignment -malign-data=cacheline -pipe -Wl,--sort-common -fno-stack-protector -Wl,--build-id=sha1 -fexceptions" \
-DCMAKE_SHARED_LINKER_FLAGS="-O3 --param=lto-max-streaming-parallelism=16 -flto=16 -Wl,--no-as-needed -pthread -lpthread -ffat-lto-objects -fuse-ld=bfd -fuse-linker-plugin -march=native -mtune=native -Wall -Wl,-O2 -falign-functions=32 -flimit-function-alignment -malign-data=cacheline -pipe -Wl,--sort-common -fno-stack-protector -Wl,--build-id=sha1 -fexceptions" \
-DENABLE_LINKER_BUILD_ID:BOOL=ON \
-DLIBCLANG_BUILD_STATIC:BOOL=ON \
-DCLANG_BUILD_TOOLS:BOOL=ON \
-DCLANG_DEFAULT_LINKER=bfd \
-DLLVM_ENABLE_LIBCXX:BOOL=OFF \
-DLLVM_STATIC_LINK_CXX_STDLIB:BOOL=OFF \
-DCLANG_DEFAULT_CXX_STDLIB:STRING=libstdc++ \
-DCLANG_DEFAULT_RTLIB:STRING=libgcc \
-DCLANG_DEFAULT_UNWINDLIB:STRING=libgcc \
-DCLANG_ENABLE_STATIC_ANALYZER:BOOL=ON \
-DCLANG_INCLUDE_TESTS:BOOL=OFF \
-DCLANG_LINK_CLANG_DYLIB:BOOL=OFF \
-DLLVM_LINK_LLVM_DYLIB:BOOL=OFF \
-DLLVM_BUILD_LLVM_DYLIB:BOOL=ON \
-DCOMPILER_RT_BUILD_SANITIZERS:BOOL=OFF \
-DCOMPILER_RT_BUILD_XRAY:BOOL=OFF \
-DLLVM_BINUTILS_INCDIR=/usr/include \
-DLLVM_BUILD_EXAMPLES:BOOL=OFF \
-DLLVM_BUILD_RUNTIME:BOOL=ON \
-DLLVM_BUILD_TOOLS:BOOL=ON \
-DLLVM_ENABLE_ASSERTIONS:BOOL=OFF \
-DLLVM_ENABLE_BINDINGS:BOOL=OFF \
-DLLVM_ENABLE_DOXYGEN:BOOL=OFF \
-DLLVM_ENABLE_EH:BOOL=ON \
-DLLVM_ENABLE_UNWIND_TABLES:BOOL=ON \
-DLLVM_ENABLE_FFI:BOOL=ON \
-DFFI_INCLUDE_DIR=`pkg-config --variable=includedir libffi` \
-DLLVM_ENABLE_LIBXML2:BOOL=ON \
-DLLVM_ENABLE_PIC=ON \
-DLLVM_ENABLE_RTTI:BOOL=ON \
-DLLVM_ENABLE_THREADS:BOOL=ON \
-DLLVM_ENABLE_Z3_SOLVER:BOOL=OFF \
-DLLVM_ENABLE_ZLIB:BOOL=ON \
-DLLVM_INCLUDE_TESTS:BOOL=OFF \
-DLLVM_INCLUDE_TOOLS:BOOL=ON \
-DLLVM_INSTALL_UTILS:BOOL=ON \
-DLLVM_OPTIMIZED_TABLEGEN:BOOL=ON \
-DLLVM_TARGETS_TO_BUILD="Native;X86" \
-DLLVM_TOOL_CLANG_TOOLS_EXTRA_BUILD:BOOL=ON \
-DLLVM_TOOL_COMPILER_RT_BUILD:BOOL=OFF \
-DLLVM_USE_LINKER:STRING=bfd \
-DPYTHON_EXECUTABLE:FILEPATH=/usr/bin/python3 \
-DLLVM_ENABLE_PROJECTS="clang" \
-Wno-dev
